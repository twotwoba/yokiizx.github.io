---
title: 'JS中的数组与链表'
date: 2022-09-20T17:02:29+08:00
---

> 忘记在哪看见过一句话说：
> JavaScript 中的数组只不过是名字叫数组而已，与数据结构中的数组几乎没有关系

JSArray 继承自 JSObject，是特殊的对象，内部也是用 key-value 的形式存储数据，所以可以存放不同类型的值，这在 Java 类语言的数组是做不到的。

> 专业术语要注意准确，数组根据下标索引查找元素的时间复杂度为 O(1) ，而不是数组查找的时间复杂度，即使是用二分查找也得 O(logn)。

## 快慢数组

JavaScript 中的数组分为快慢数组。

- 快数组：存储结构是`FixedArray`，`length <= elements.length()`，push 和 pop 会动态扩容缩容
- 慢数组：存储结构是`HashTable`，数组下标作为 key

快数组，使用的是一段连续的内存，可以直接用索引定位，新创建的数组默认就是快数组，new Array(x)，当数组长度大于 x 继续 push 会动态扩容。

慢数组，不需要连续内存空间，维护一个哈希表，与快数组相比性能较差。

##### 快慢转换

快变慢：

1. 当前加入的索引减去当前容量(capacity)大于等于 1024。（index - capacity >= 1024），意味着空洞大于等于 1024。
2. 3*扩容后容量*2 <= 新容量
   > 其实目的就是节省内存空间

慢变快：

1. 当慢数组 节省空间<= 50% 的时候就会变成快数组。

##### 为什么下标从 0 开始

1. 历史原因: C -> Java -> JavaScript
2. 数组寻址时减少 CPU 指令运算
3. 物理内存的地址是从 0 开始的

```JavaScript
// 寻址公式
arr[i] = base_address + i * type_size
// 其中base_address为数组arr首地址，arr0就是 **偏移量** 为0的数组，即数组arr首地址；
// i为偏移量，type_size为数组类型字节数，比如int为32位，即4个字节

arr[i] = base_address + （i -1）* type_size
// 多了一次减1的运算
```

## 一点经验

- 二维数组初始化：

  ```JavaScript
  const dp = Array.from(Array(m), () => Array(n).fill(0))
  ```

- 索引区间长度：
  - `[i..j]`，闭区间索引之间的长度是`j - i + 1`
  - `(i..j)`，开区间索引之间的长度是`j - i - 1`
  - `[i..j)`，表示从 i 到 j 需要多少步，`j - i`


## 链表

JS 中没有链表的数据结构，一般也就是根据对象，去模拟，next 作为指针。

一般对链表的操作经常需要用额外一个指针去穿针引线  
当需要操作头结点的时候，经常会使用哨兵守卫的技巧（单调栈中经常使用），在链表中也被称为‘虚拟头结点 dummy’。
