---
title: 'åŠ¨æ€è§„åˆ’ä¹‹ä¹°å–è‚¡ç¥¨'
date: 2022-10-12T09:31:28+08:00
tags: [algorithm, dynamic programming]
---

##### [121. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº](https://leetcode.cn/problems/best-time-to-buy-and-sell-stock/)

è¿™é“é¢˜æœ€ç›´è§‚çš„æ–¹æ³•æ˜¯ï¼Œè´ªå¿ƒç®—æ³• --- æ­¤é¢˜ä¸­ï¼Œåªéœ€è¦å·¦è¾¹æœ€å°ï¼Œå³è¾¹æœ€å¤§ï¼Œé‚£ä¹ˆå°±æ˜¯æœ€å¤§åˆ©æ¶¦å•¦ ğŸ•¶ã€‚

```JavaScript
/**
 * @param {number[]} prices
 * @return {number}
 */
var maxProfit = function(prices) {
    // è´ªå¿ƒç®—æ³•
    let min = Infinity
    let res = 0
    for(let i = 0; i < prices.length; ++i) {
        min = Math.min(min, prices[i])
        res = Math.max(res, prices[i] - min)
    }
    return res
};
```

ä¸è¿‡æˆ‘ä»¬çš„é‡ç‚¹æ˜¯åŠ¨æ€è§„åˆ’ï¼Œè¿˜æ˜¯å¾—å¥½å¥½åˆ†æä¸€ä¸‹ï¼š

- çŠ¶æ€ å¤©æ•°/æŒæœ‰çŠ¶æ€(æœªæŒæœ‰/æŒæœ‰)ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªäºŒç»´ dp æ•°ç»„ï¼Œç®—å‡ºæ¯ä¸ªç¬¬ i å¤©æŒæœ‰æˆ–ä¸æŒæœ‰çŠ¶æ€ä¸‹çš„æœ€å¤§æ”¶ç›Š
- é€‰æ‹© ä¹°å…¥/å–å‡º/ä¸æ“ä½œ

```JavaScript
/**
 * @param {number[]} prices
 * @return {number}
 */
var maxProfit = function(prices) {
    // å®šä¹‰dp[i][0] è¡¨ç¤ºç¬¬iå¤©æœªæŒæœ‰è‚¡ç¥¨çš„æœ€å¤§ç°é‡‘; dp[i][0] è¡¨ç¤ºç¬¬iå¤©æŒæœ‰è‚¡ç¥¨çš„æœ€å¤§ç°é‡‘
    const m = prices.length
    const dp = new Array(m).fill([0, 0])
    dp[0] = [0, -prices[0]] // [æœªæŒæœ‰, æŒæœ‰]
    for(let i = 1; i < m; ++i) {
        dp[i] = [
            // æ‰‹é‡ŒæœªæŒæœ‰ å‰ä¸€å¤©æœªæŒæœ‰(ä¸æ“ä½œ)/å–äº†
            Math.max(dp[i-1][0], dp[i-1][1] + prices[i]),
            // æ‰‹é‡ŒæŒæœ‰   å‰ä¸€å¤©æŒæœ‰(ä¸æ“ä½œ)/ä¹°äº†
            Math.max(dp[i-1][1], -prices[i])
        ]
    }
    return dp[m-1][0]
};
```

å…¶å® `[æœªæŒæœ‰, æŒæœ‰]` è¿™å°±æ˜¯æœ€ç®€å•çš„ ã€ŒçŠ¶æ€æœºã€ äº†ï¼Œå’Œä¹‹å‰ `æ‰“å®¶åŠ«èˆIII` çš„ç±»ä¼¼ã€‚

##### [122.ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº II](https://leetcode.cn/problems/best-time-to-buy-and-sell-stock-ii/)

ä¸ä¸Šä¸€é¢˜ä¸åŒçš„åœ°æ–¹åªæœ‰ä¸€ä¸ªï¼Œå°±æ˜¯å¯ä»¥è¿ç»­äº¤æ˜“å¤šæ¬¡ã€‚çŠ¶æ€ä¸é€‰æ‹©éƒ½ä¸å˜ï¼Œå½±å“çš„åªæ˜¯ä¹°å…¥çš„æ—¶å€™çš„çŠ¶æ€å˜åŒ–ã€‚

```JavaScript
/**
 * @param {number[]} prices
 * @return {number}
 */
var maxProfit = function(prices) {
    const m = prices.length
    const dp = new Array(m).fill([0,0])
    dp[0] = [0, -prices[0]]
    for(let i = 1; i < m; ++i) {
        dp[i] = [
            Math.max(dp[i-1][0], dp[i-1][1] + prices[i]),
            Math.max(dp[i-1][1], dp[i-1][0] - prices[i]) // æ³¨æ„è¿™é‡Œï¼Œåªäº¤æ˜“ä¸€æ¬¡ï¼Œä¸€å®šæ˜¯-prices[i] äº¤æ˜“å¤šæ¬¡å°±è¦å—åˆ°ä¸Šä¸€æ¬¡æœªæŒæœ‰ä¹°å…¥çš„æƒ…å†µäº†
        ]
    }
    return dp[m-1][0]
};
```

##### [123. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº III](https://leetcode.cn/problems/best-time-to-buy-and-sell-stock-iii/description/)

121 åªèƒ½äº¤æ˜“ä¸€æ¬¡ï¼Œ122 å¯ä»¥äº¤æ˜“ n æ¬¡ï¼Œè¿™æ¬¡ï¼Œè‡³å¤šäº¤æ˜“ä¸¤æ¬¡ï¼Œä¹Ÿå°±æ˜¯å¯èƒ½äº¤æ˜“[0..2]æ¬¡~ æäººå˜›è¿™ä¸æ˜¯(â•¥â•¯^â•°â•¥)

é€‰æ‹©ä» ã€Œä¹°å…¥/å–å‡ºã€ æ‹“å±•ä¸º ã€Œç¬¬ä¸€æ¬¡ä¹°å…¥/ç¬¬ä¸€æ¬¡å–å‡º/ç¬¬äºŒæ¬¡ä¹°å…¥/ç¬¬äºŒæ¬¡å–å‡ºã€ï¼Œç›´æ¥å½±å“åˆ°äº†æŒæœ‰çŠ¶æ€ï¼Œå¥½ï¼Œé‚£ä¹ˆå°±æ¥æŠŠçŠ¶æ€æœºå‘æ‰¬å…‰å¤§å§ï¼

```JavaScript
/**
 * @param {number[]} prices
 * @return {number}
 */
var maxProfit = function(prices) {
    const m = prices.length
    const dp = new Array(m).fill([0,0,0,0]) // [1æ— ,1æœ‰,2æ— ,2æœ‰]
    dp[0] = [ 0, -prices[0], 0, -prices[0]] // å…³äºç¬¬äºŒæ¬¡å¯ä»¥ç†è§£ä¸ºç¬¬ä¸€æ¬¡ç›´æ¥ä¹°å®Œåå–æ‰äº†
    for(let i = 1; i < m; ++i) {
        dp[i] = [
            Math.max(dp[i-1][0], dp[i-1][1] + prices[i]), // å–
            Math.max(dp[i-1][1], -prices[i]),             // ä¹°
            Math.max(dp[i-1][2], dp[i-1][3] + prices[i]), // å–
            Math.max(dp[i-1][3], dp[i-1][0] - prices[i]), // ä¹°
        ]
    }
    return dp[m-1][2]
};
```

å…¶å®æˆ‘æ˜¯æ•…æ„æŠŠ dp çš„å®šä¹‰ "å–" æ”¾åˆ° "ä¹°" å‰é¢ï¼Œç›®çš„æ˜¯ä¸è¦è®°å…¬å¼ï¼Œè€Œæ˜¯æ¸…æ¥šæ¨ç†é€»è¾‘ï¼Œå®é™… å…ˆä¹°åå– çš„å®šä¹‰æ›´åŠ æ–¹ä¾¿ç†è§£ä¸å¥½çœ‹ ğŸ˜ã€‚

å¦å¤–ï¼Œè¿™é“é¢˜æŠŠ i è¿™å±‚ç»´åº¦å¹²æ‰ï¼Œå°±æ˜¯ç©ºé—´å‹ç¼©ç‰ˆæœ¬äº†ã€‚

##### [188. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº IV](https://leetcode.cn/problems/best-time-to-buy-and-sell-stock-iv/)

ç›¸æ¯” 123 é¢˜ï¼Œè¿™é“é¢˜å› ä¸ºæ˜¯ k æ¬¡äº¤æ˜“ï¼Œå¹¶ä¸èƒ½ç²¾å‡†ç¡®å®šæ¯å¤©çš„æŒæœ‰çŠ¶æ€ã€‚

ç›¸å¯¹äº 121,122 é¢˜ç­‰äºæ˜¯å¤šäº†ä¸€ä¸ª ã€Œäº¤æ˜“æ¬¡æ•°ã€ çš„çŠ¶æ€ï¼Œé‚£ä¹ˆéœ€è¦å¯¹æ¯å¤©çš„çŠ¶æ€è¿›è¡Œæ‹“å±•ã€‚

```JavaScript
/**
 * @param {number} k
 * @param {number[]} prices
 * @return {number}
 */
var maxProfit = function(k, prices) {
    const m = prices.length
    const dp = Array.from(new Array(m), () => new Array(k + 1).fill([0, 0]))

    for(let j = 0; j <= k; ++j) {
        dp[0][j] = [0, -prices[0]]
    }
    for(let i = 1; i < m; ++i) {
        dp[i][0] = [0, Math.max(dp[i-1][0][1], dp[i-1][0][0] - prices[i])]
    }

    for(let i = 1; i < m; ++i) {
        for(let j = 1; j <= k; ++j) {
            dp[i][j] = [
                Math.max(dp[i-1][j][0], dp[i-1][j-1][1] + prices[i]),
                Math.max(dp[i-1][j][1], dp[i-1][j][0] - prices[i])
            ]
        }
    }
    return dp[m-1][k][0]
};
```

æ³¨æ„ä¸¤ç‚¹å§ï¼š1. ç¬¬äºŒä¸ªç»´åº¦äº¤æ˜“æ¬¡æ•°ï¼Œåˆå§‹åŒ– dp æ—¶ï¼Œå®ƒå…·ä½“æ˜¯[0..k]ï¼Œæ‰€ä»¥å®¹é‡åº”è¯¥æ˜¯ `k + 1`ï¼›2. base case åˆå§‹åŒ–é¡ºåºä¸èƒ½é¢ å€’ï¼Œå…ˆåˆå§‹åŒ– i ä¸º 0ï¼Œåœ¨åˆå§‹åŒ– k ä¸º 0 çš„æƒ…å†µã€‚

ä¸éš¾å‘ç°ï¼Œ123 é¢˜å°±æ˜¯è¿™é“é¢˜ k = 2 çš„æƒ…å†µ~

##### [309.æœ€ä½³ä¹°å–è‚¡ç¥¨æ—¶æœºå«å†·å†»æœŸ](https://leetcode.cn/problems/best-time-to-buy-and-sell-stock-with-cooldown/)

ç›¸æ¯” 121 é¢˜ï¼Œå¤šäº†ä¸ªå†·å†»æœŸçš„é™åˆ¶ï¼Œè½¬æ¢è¿‡æ¥å°±æ˜¯æ¯å¤©çš„çŠ¶å†µåˆå¤šäº†ä¸€ç§ -- å†·å†»æœŸå³å–å‡ºåç¬¬äºŒå¤©ä¸èƒ½æ“ä½œã€‚  
æ‰€ä»¥å½“å¤©çš„çŠ¶æ€å°±æ˜¯ ã€ŒæŒæœ‰/æœªæŒæœ‰(éå†·å†»æœŸ)/æœªæŒæœ‰(å†·å†»æœŸ)ã€ï¼Œå…¶å®å°±æ˜¯æŠŠçŠ¶æ€æœºæ‹“å±•äº†ä¸€ä½ã€‚

```JavaScript
/**
 * @param {number[]} prices
 * @return {number}
 */
var maxProfit = function(prices) {
    const m = prices.length
    // æŒæœ‰/æœªæŒæœ‰(å†·å†»æœŸ)/æœªæŒæœ‰(éå†·å†»æœŸ)
    const dp = new Array(m).fill([0,0,0])
    // base case
    dp[0] = [-prices[0], 0, 0]
    for(let i = 1; i < m; ++i) {
        dp[i] = [
            Math.max(dp[i-1][0], dp[i-1][2] - prices[i]), // ä¹‹å‰å·²ç»æŒæœ‰æˆ–è€…ä»éå†·å†»æœŸå–å‡º
            dp[i-1][0] + prices[i], // ä¸€å®šæ˜¯ä»Šå¤©å–æ‰äº†
            Math.max(dp[i-1][1], dp[i-1][2]) // å¯èƒ½æ˜¯ä»å†·å†»æœŸæˆ–è€…éå†·å†»æœŸè¿‡æ¥çš„
        ]
    }
    return Math.max(dp[m-1][1], dp[m-1][2])
};
```

##### [714.ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºå«æ‰‹ç»­è´¹](https://leetcode.cn/problems/best-time-to-buy-and-sell-stock-with-transaction-fee/)

```JavaScript
/**
 * @param {number[]} prices
 * @param {number} fee
 * @return {number}
 */
var maxProfit = function(prices, fee) {
    const m = prices.length
    const dp = new Array(m).fill([0, 0])
    dp[0] = [0, -prices[0]]
    for(let i = 1; i < m; ++i) {
        dp[i] = [
            Math.max(dp[i-1][0], dp[i-1][1] + prices[i] - fee),
            Math.max(dp[i-1][1], dp[i-1][0] - prices[i] )
        ]
    }
    return dp[m-1][0]
};
```

å’Œ 122 é¢˜æ²¡ä»€ä¹ˆä¸¤æ ·ï¼Œå¤šäº†ä¸ªè´¹ç”¨è€Œå·²~

##### æ€»ç»“

è‚¡ç¥¨é—®é¢˜ï¼Œå¯ä»¥è®©æˆ‘ä»¬å¯¹ ã€ŒçŠ¶æ€ã€ å’Œ ã€Œé€‰æ‹©ã€ çš„ç†è§£æ›´åŠ æ·±åˆ»ï¼ŒåŒæ—¶å¯¹ ã€ŒçŠ¶æ€æœºã€ çš„è¿ç”¨ä¹Ÿæ›´åŠ ç†Ÿç»ƒï¼Œåº”å½“ç†è§£æ€æƒ³å¹¶ç†Ÿç»ƒè¿ç”¨ã€‚
