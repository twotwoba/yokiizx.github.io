---
title: 'æ•°ç»„-å‰ç¼€å’Œæ•°ç»„'
date: 2023-02-19T15:57:07+08:00
tags: [Array]
series: [data structure, trick]
categories: [algorithm]
---

## æ¦‚å¿µ

åº”ç”¨åœºæ™¯ï¼šåœ¨åŸå§‹æ•°ç»„ä¸ä¼šè¢«ä¿®æ”¹çš„æƒ…å†µä¸‹ï¼Œ**å¿«é€Ÿã€é¢‘ç¹æŸ¥è¯¢æŸä¸ªåŒºé—´çš„ç´¯åŠ å’Œ**ã€‚

æ ¸å¿ƒæ€è·¯ï¼šå¼€è¾Ÿæ–°æ•°ç»„ `preSum[i]` æ¥å­˜å‚¨åŸæ•°ç»„ `nums[0..i-1] `çš„ç´¯åŠ å’Œï¼Œ`preSum[0] = 0`ã€‚è¿™æ ·ï¼Œå½“æ±‚åŸæ•°ç»„åŒºé—´å’Œå°±æ¯”è¾ƒå®¹æ˜“äº†ï¼ŒåŒºé—´ `[i..j]` çš„å’Œç­‰äº `preSum[j+1] - preSum[i]` çš„ç»“æœå€¼ã€‚

```JavaScript
const preSum = [0]
preSum[i] = preSum[i - 1] + nums[i - 1]
// æŸ¥è¯¢
preSum[r + 1] - preSum[l]

// æˆ–è€…
const preSum = [nums[0]]
preSum[i] = preSum[i-1] + nums[i]
// æŸ¥è¯¢
preSum[r] - preSum[l-1] // éœ€è¦åˆ¤æ–­ l ä¸º 0 çš„æƒ…å†µï¼Œç›´æ¥è¿”å› preSum[r]ï¼Œè¿™ç§çš„åŠ£åŠ¿æ˜¯éœ€è¦åˆ¤æ–­è¾¹ç•Œæ¡ä»¶
```

### æ„é€ ï¼š[lc.303 åŒºåŸŸå’Œæ£€ç´¢-æ•°ç»„ä¸å¯å˜](https://leetcode.cn/problems/range-sum-query-immutable/)

```JavaScript
/**
 * @param {number[]} nums
 */
var NumArray = function(nums) {
    this.preSum = [0] // preSum é¦–ä½ä¸º0 ä¾¿äºè®¡ç®—
    for(let i = 1; i <= nums.length; ++i) {
        this.preSum[i] = this.preSum[i - 1] + nums[i -1]
    }
};

/**
 * @param {number} left
 * @param {number} right
 * @return {number}
 */
NumArray.prototype.sumRange = function(left, right) {
    return this.preSum[right + 1] - this.preSum[left]
};

/**
 * Your NumArray object will be instantiated and called as such:
 * var obj = new NumArray(nums)
 * var param_1 = obj.sumRange(left,right)
 */
```

---

ä¸Šæ–¹é‚£ç§äº‹å®˜è§£ç»™å‡ºçš„é€»è¾‘ï¼Œä¸‹é¢è¿™ç§å¯èƒ½æ›´å®¹æ˜“ç†è§£ä¸€äº›ã€‚

```js
/**
 * @param {number[]} nums
 */
var NumArray = function (nums) {
  this.preSums = [nums[0]]
  for (let i = 1; i < nums.length; ++i) {
    this.preSums[i] = this.preSums[i - 1] + nums[i]
  }
}

/**
 * @param {number} left
 * @param {number} right
 * @return {number}
 */
NumArray.prototype.sumRange = function (left, right) {
  if (left === 0) return this.preSums[right]
  return this.preSums[right] - this.preSums[left - 1]
}

/**
 * Your NumArray object will be instantiated and called as such:
 * var obj = new NumArray(nums)
 * var param_1 = obj.sumRange(left,right)
 */
```

### æ„é€ ï¼š[lc.304 äºŒç»´åŒºåŸŸå’Œæ£€ç´¢-çŸ©é˜µä¸å¯å˜](https://leetcode.cn/problems/range-sum-query-2d-immutable/)

```js
/**
 * @param {number[][]} matrix
 */
var NumMatrix = function (matrix) {
  const row = matrix.length
  const col = matrix[0].length
  this.sums = Array.from(Array(row + 1), () => Array(col + 1).fill(0))
  for (let i = 0; i < row; ++i) {
    for (let j = 0; j < col; ++j) {
      this.sums[i + 1][j + 1] =
        this.sums[i + 1][j] + this.sums[i][j + 1] - this.sums[i][j] + matrix[i][j]
    }
  }
  console.log(this.sums)
}

/**
 * @param {number} row1
 * @param {number} col1
 * @param {number} row2
 * @param {number} col2
 * @return {number}
 */
NumMatrix.prototype.sumRegion = function (row1, col1, row2, col2) {
  return (
    this.sums[row2 + 1][col2 + 1] -
    this.sums[row1][col2 + 1] -
    this.sums[row2 + 1][col1] +
    this.sums[row1][col1]
  )
}

/**
 * Your NumMatrix object will be instantiated and called as such:
 * var obj = new NumMatrix(matrix)
 * var param_1 = obj.sumRegion(row1,col1,row2,col2)
 */
```

### lc.523 è¿ç»­çš„å­æ•°ç»„å’Œ

è¿™é“é¢˜æœ‰ç‚¹æ„æ€çš„ï¼Œé¦–å…ˆè¦çŸ¥é“ä¸€ä¸ªæ•°å­¦çŸ¥è¯†ï¼š**åŒä½™å®šç†ï¼š(a - b) % k == 0ï¼Œåˆ™ a % k == b % k**ã€‚

æ ¹æ®é¢˜æ„ï¼Œéœ€è¦è·å–åˆ°çš„ä¿¡æ¯æ˜¯ï¼š**(preSum[j] - preSum[i]) % k === 0**ï¼Œå¦‚è¿‡å­˜åœ¨åˆ™è¿”å› trueï¼Œé‚£ä¹ˆå°±å¯ä»¥è½¬åŒ–ä¸ºï¼š**å¯»æ‰¾æ˜¯å¦æœ‰ä¸¤ä¸ªå‰ç¼€å’Œèƒ½ % k åï¼Œä½™æ•°ç›¸åŒçš„é—®é¢˜äº†~**ï¼Œé‚£å°±å¾ˆè‡ªç„¶æƒ³åˆ°ç”¨å“ˆå¸Œè¡¨æ¥å­˜å‚¨ `{ä½™æ•°ï¼šç´¢å¼•}`äº†ï¼Œä¸ç„¶è¿™é¢˜è¿˜çœŸæŒºéš¾æƒ³çš„~ å†ä¸€æ¬¡ respect æ•°å­¦ï¼

```js
var checkSubarraySum = function (nums, k) {
  if (nums.length <= 1) return false
  const map = { 0: -1 }
  let preSum = 0
  for (let i = 0; i < nums.length; ++i) {
    preSum += nums[i]
    let b = preSum % k
    if (map[b] >= -1) {
      // å·¦å¼€å³é—­åŒº
      if (i - map[b] >= 2) {
        return true
      }
    } else {
      map[b] = i
    }
  }
  return false
}
```

**Butï¼è¯·æ³¨æ„ï¼Œæœ‰å‘**ï¼Œä¸Šé¢çš„ç®—æ³•æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œç„¶è€Œæ•°æ®é‡ä¸€ä¸‹ï¼Œä¸”æ¯ä¸ªæ•°éƒ½å¾ˆå¤§ï¼Œåˆ™æœ‰å¯èƒ½æœ‰æ•°å­—æº¢å‡ºçš„é£é™©ï¼ŒåŠ›æ‰£ä¸Šæœ‰ä¸ªæµ‹è¯•ç”¨ä¾‹å°±æ˜¯è¿™æ ·çš„è¶…å‡ºèŒƒå›´äº†~~~ï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦ç”¨**ä½™æ•°å»ç´¯åŠ ï¼**

```js
/**
 * @param {number[]} nums
 * @param {number} k
 * @return {boolean}
 */
var checkSubarraySum = function (nums, k) {
  if (nums.length <= 1) return false
  // æ³¨æ„è¿™é‡Œï¼šåˆå§‹ key ä¸º 0ï¼Œvalue ä¸º -1ï¼Œæ˜¯ä¸ºäº†è®¡ç®—ç¬¬ä¸€ä¸ªå¯ä»¥æ•´é™¤ k çš„å­æ•°ç»„é•¿åº¦
  const map = { 0: -1 }
  let remainder = 0
  for (let i = 0; i < nums.length; ++i) {
    remainder = (remainder + nums[i]) % k
    if (map[remainder] >= -1) {
      if (i - map[remainder] >= 2) {
        // å·¦å¼€å³é—­åŒºé—´
        return true
      }
    } else {
      map[remainder] = i
    }
  }
  return false
}
```

### lc.525 è¿ç»­æ•°ç»„

ç»ï¼Œå¯ä»¥æŠŠ 0 çœ‹æˆ -1ï¼Œè½¬ä¸ºæ±‚å‰ç¼€å’Œä¸º 0 çš„æƒ…å†µã€‚å®ç°ä¸Šç”¨ä¸€ä¸ª counter å˜é‡å³å¯ã€‚

```js
/**
 * @param {number[]} nums
 * @return {number}
 */
var findMaxLength = function (nums) {
  if (nums.length <= 1) return 0
  let max = 0
  const map = { 0: -1 }
  let counter = 0
  for (let i = 0; i < nums.length; ++i) {
    nums[i] === 1 ? ++counter : --counter
    // å“ˆå¸Œè¡¨ä¸­å°±æœ‰è®°å½•ï¼Œè¡¨æ˜æ­¤åˆ» åŒºé—´å‰ç¼€å’Œä¹‹å·® ä¸­ 0 å’Œ 1 çš„æ•°é‡ç›¸ç­‰
    // ä¸¾ä¸ªä¾‹å­ [1,1,1,0(-1)] å¯¹åº”çš„å‰ç¼€å’Œä¸º  1,2,3,2ï¼Œ é‚£ä¹ˆ (1, 3] åŒºé—´ 1 ä¸ª 0 å’Œ 1 ä¸ª 1ï¼Œé•¿åº¦ä¸º 3-1=2
    if (map[counter] >= -1) {
      max = Math.max(max, i - map[counter])
    } else {
      map[counter] = i
    }
  }
  return max
}
```

ä¸Šé¢ä¸¤é¢˜ï¼Œæœ‰ä¸€ä¸¢ä¸¢ç±»ä¼¼ï¼Œæ¯”å¦‚ä¸€ç§æ„Ÿè§‰ï¼Œå½“é€šè¿‡å“ˆå¸Œè¡¨æ¥å­˜å‚¨ `{need: ç´¢å¼•}` æ—¶ï¼Œéƒ½éœ€è¦è®¾å®š map åˆå§‹ä¸º `{0: -1}`ï¼Œå¯ä»¥ç†è§£ä¸º**ç©ºçš„å‰ç¼€çš„å…ƒç´ å’Œä¸º 0ï¼Œç©ºçš„å‰ç¼€çš„ç»“æŸä¸‹æ ‡ä¸º âˆ’1**ã€‚å†ä¸€ä¸ªå‰ç¼€å’Œä¹‹å·®åŒºé—´ä¸ºå·¦å¼€å³é—­åŒºé—´ `(i, j]`ï¼Œæ‰€ä»¥é•¿åº¦ä¸º j - iã€‚

### [lc.528 æŒ‰æƒé‡éšæœºé€‰æ‹©](https://leetcode.cn/problems/random-pick-with-weight/)

```JavaScript
/**
 * @param {number[]} w
 */
var Solution = function (w) {
  // å‰ç¼€å’Œï¼Œç„¶åéšæœºæ•°ï¼Œçœ‹çœ‹è½åœ¨å‰ç¼€å’Œçš„å“ªä¸ªåŒºé—´ï¼Œè¿™æ ·å°±ä¿è¯äº†æºæ•°æ®çš„éšæœºæ€§å¸¦ä¸Šäº†æƒé‡ï¼Œå½“ç„¶éœ€è¦é…åˆäºŒå‰æœç´¢å·¦è¾¹ç•Œ
  this.presum = new Array(w.length + 1)
  this.presum[0] = 0
  for (let i = 1; i < this.presum.length; ++i) {
    this.presum[i] = this.presum[i - 1] + w[i - 1]
  }
}

/**
 * @return {number}
 */
Solution.prototype.pickIndex = function () {
  const x = Math.floor(Math.random() * this.presum[this.presum.length - 1]) + 1
  return findLeftIndex(this.presum, x) - 1 // å‰ç¼€å’Œçš„ç´¢å¼•æ¯”åŸæ•°ç»„çš„ç´¢å¼•éƒ½å¤§1, æ‰€ä»¥å‡æ‰
}

function findLeftIndex(presum, target) {
  let l = 1,
    r = presum.length // å‰ç¼€å’Œé¦–å°¾æ˜¯å ä½0, æ‰€ä»¥ä»1å¼€å§‹åˆ°æœ€åä¸€ä¸ªç´¢å¼•ç»“æŸ(è¿™é‡Œé‡‡ç”¨å·¦é—­å³å¼€)
  while (l < r) {
    const mid = l + ((r - l) >> 1)
    if (presum[mid] < target) {
      l = mid + 1
    } else {
      r = mid
    }
  }
  return l
}
```

### [lc.560 å’Œä¸º k çš„å­æ•°ç»„](https://leetcode.cn/problems/subarray-sum-equals-k/)

```JavaScript
/**
 * @param {number[]} nums
 * @param {number} k
 * @return {number}
 */
var subarraySum = function(nums, k) {
    const preSum = [0]
    for(let i = 1; i <= nums.length; ++i) {
        preSum[i] = preSum[i-1] + nums[i-1]
    }
    let count = 0
    // éå†å‡ºæ‰€æœ‰åŒºé—´
    for(let i = 0; i < nums.length; ++i) {
        for(let j = i; j < nums.length; ++j) {
            preSum[j+1] - preSum[i] === k && ++count
        }
    }
    return count
};
```

è¿™æ ·åšèƒ½å¾—åˆ°æ­£ç¡®ç»“æœï¼Œä½†æ˜¯å¹¶ä¸èƒ½ ACï¼Œæ—¶é—´å¤æ‚åº¦ O(n^2)ï¼Œä¸çŸ¥é“è°æäº†ä¸ªæ¶å¿ƒçš„æµ‹è¯•ç”¨ä¾‹ã€‚ã€‚ã€‚ä¼šè¶…æ—¶~

çœ‹äº†ä¸‹é¢˜è§£ï¼Œå¯ä»¥ä½¿ç”¨å“ˆå¸Œè¡¨è¿›è¡Œä¼˜åŒ–

```js
var subarraySum = function (nums, k) {
  const map = { 0: 1 }
  let preSum = 0
  let res = 0
  for (const num of nums) {
    preSum += num
    if (map[preSum - k]) {
      res += map[preSum - k]
    }

    if (map[preSum]) {
      map[preSum]++
    } else {
      map[preSum] = 1
    }
  }

  return res
}
```

### lc.724 å¯»æ‰¾æ•°ç»„çš„ä¸­å¿ƒä¸‹æ ‡ easy

```js

```

### lc.918 ç¯å½¢æ•°ç»„çš„æœ€å¤§å’Œ

```js

```

### lc.974 å’Œå¯è¢« k æ•´é™¤çš„å­æ•°ç»„

```js

```

### å‰ç¼€ç§¯ä¸åç¼€ç§¯

### [238. é™¤ä»¥è‡ªèº«ä»¥å¤–çš„æ•°ç»„çš„ä¹˜ç§¯](https://leetcode.cn/problems/product-of-array-except-self/)

æ•°ç»„ numsï¼Œæ±‚é™¤äº† nums[i] ä¹‹å¤–æ‰€æœ‰æ•°å­—çš„ä¹˜ç§¯ === `preMulti * postMulti`

```js
/**
 * @param {number[]} nums
 * @return {number[]}
 */
var productExceptSelf = function (nums) {
  const n = nums.length
  const front = new Array(n)
  const end = new Array(n)
  front[0] = 1
  end[n - 1] = 1
  for (let i = 1; i < n; i++) {
    front[i] = front[i - 1] * nums[i - 1]
  }
  for (let i = n - 2; i >= 0; i--) {
    end[i] = end[i + 1] * nums[i + 1]
  }
  const res = []
  for (let i = 0; i < n; i++) {
    res[i] = front[i] * end[i]
  }
  return res
}
```

ä¼˜åŒ–

```js
var productExceptSelf = function (nums) {
  // ä¼˜åŒ– åŠ¨æ€æ„é€ å‰ç¼€å’Œåç¼€ ä¸€æ¬¡éå†, è®©è¿”å›æ•°ç»„è‡ªèº«æ¥æ‰¿è½½
  const res = new Array(nums.length).fill(1)
  // æ±‚å‡ºå·¦ä¾§æ‰€æœ‰ä¹˜ç§¯
  for (let i = 1; i < nums.length; i++) {
    res[i] = nums[i - 1] * res[i - 1]
  }
  // å³ä¾§çš„ä¹˜ç§¯éœ€è¦åŠ¨æ€çš„æ±‚å‡º, å€’å™éå†
  let r = 1
  for (let i = nums.length - 1; i >= 0; --i) {
    res[i] = res[i] * r
    r *= nums[i]
  }
  return res
}
```

> lc.327 lc.862 ä¸¤é“ hard é¢˜ï¼Œåç»­æœ‰æ—¶é—´å†çœ‹çœ‹ ğŸ˜
